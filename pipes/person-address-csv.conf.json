{
  "_id": "person-address-csv",
  "type": "pipe",
  "source": {
    "type": "dataset",
    "dataset": "global-person"
  },
  "transform": {
    "type": "dtl",
    "rules": {
      "default": [
        ["filter",
          ["intersects",
            ["list", "~:crm:person", "~:hr:person", "~:erp:person"], "_S.rdf:type"]
        ],
        ["copy", "_id"],
        ["add", "Name", "_S.global-person:fullname"],
        ["add", "Address", "_S.global-person:address"],
        ["add", "Postal",
          ["concat", "_S.global-person:zipcode", " ", "_S.global-person:city"]
        ],
        ["add", "Country", "_S.global-person:country"]
      ]
    }
  }
}
